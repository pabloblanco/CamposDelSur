<div class="box">
    <div class="box-header with-border">
      <h3 class="box-title">Cobranzas </h3>
      <div class="box-tools pull-right">
        <button class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
        <button class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
      </div>
    </div>

    <!-- /.box-header -->

    <div class="box-body">
      	<div class="row">
          	<div class="col-md-12">
                <div class="col-sm-14"  id="VerForm">
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="active"><a href="#home" aria-controls="home" role="tab" data-toggle="tab">Datos Generales</a></li>
                    </ul>
                    <div class="tab-content">
                        <div id="home" class="tab-pane fade in active">
                            <form role="form" name="frmCobranza" id="frmCobranza" enctype="multipart/form-data">
                                <div class="row">
                                    <div class="col-lg-12 left">
                                        <div class="row">
                                            <br>
                                            <div class="col-lg-12 col-sm-12 col-md-12 col-xs-12">
                                                <label>Los campos con (*) son obligatorios</label>
                                            </div>
                                            <div class="col-lg-4 col-md-4 col-sm-4 col-xs-12">
                                                <div class="form-group">
                                                    <input id="txtIdCobranza" type="hidden" maxlength="50" class="form-control" name="txtIdCobranza" placeholder="" autofocus="" />
                                                    <label>Número de Contrato (*):</label>
                                                    <input id="txtIdContrato" type="hidden" class="form-control" name="txtIdContrato" placeholder="" autofocus="" />
                                                    <div class="input-group has-success">
                                                        <input id="txtContrato" type="text" class="form-control" name="txtContrato" required="" placeholder="Seleccione el Número de Contrato" autofocus="" />
                                                        <span class="input-group-btn" >
                                                              <button type="button" class="btn btn-success" id="btnBuscarContratoCob"><i class='fa fa-search'></i>

                                                                            Buscar

                                                              </button>
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                        <div class="row">
                                            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 left">
                                                <div class="form-group has-success">
                                                    <label>Cementerio:</label>
                                                    <input id="txtCementerio" type="text" maxlength="150" class="form-control" name="txtCementerio" placeholder="" autofocus="" disabled/>
                                                </div>
                                            </div>
                                            <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 left">
                                                <div class="form-group has-success">
                                                    <label>Sector:</label>
                                                    <input id="txtSector" type="text" maxlength="100" class="form-control" name="txtSector" placeholder="" autofocus="" disabled/>
                                                </div>
                                            </div>

                                            <div class="col-lg-2 col-md-2 col-sm-4 col-xs-12 left">
                                                <div class="form-group has-success">
                                                   <label>Número Lote:</label>
                                                    <input id="txtLote" type="text" maxlength="50" class="form-control" name="txtLote" placeholder="" autofocus="" disabled/>
                                                </div>
                                            </div>
                                            <div class="col-lg-2 col-md-2 col-sm-4 col-xs-12">
                                                <div class="form-group has-success">
                                                    <label>Fila:</label>
                                                    <input id="txtFila" type="text" maxlength="10" name="txtFila" class="form-control" autofocus="" disabled/>
                                                </div>
                                            </div>
                                            <div class="col-lg-2 col-md-2 col-sm-4 col-xs-12">
                                                <div class="form-group has-success">
                                                    <label>Columna:</label>
                                                    <input id="txtColumna" type="text" maxlength="10" name="txtColumna" class="form-control" autofocus="" disabled/>
                                                </div>
                                            </div>
                                            <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                                                <div class="form-group has-success">
                                                    <label>Fecha Contrato:</label>
                                                    <input id="txtFechaContrato" type="date" name="txtFechaContrato" class="form-control" autofocus="" disabled/>
                                                </div>

                                            </div>
                                        </div>

                                        <div class="row">
                                            <style media="screen">
                                              #btnBuscarCuota{width: 100%;padding: 11px;display: none;}
                                              #btnBuscarCuota:hover {  background-color: #bf4637 !important;}
                                              #btnPagarCuota{width: 100%;padding: 11px;margin: 0px 5px 17px 0px;display: none;}
                                            </style>
                                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 left">
                                                <div class="form-group">
                                                    <button type="button" id="btnBuscarCuota" class="btn btn-info"><i class='fa fa-search'></i>
                                                         Buscar Cuotas Pendientes </button>
                                                </div>
                                            </div>
                                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 left">
                                                <div class="form-group">
                                                    <button type="button" id="btnPagarCuota" class="btn btn-success"><i disabled class='fa fa-search'></i>
                                                         Pagar Cuotas</button>
                                                </div>
                                            </div>


                                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 main" id="VerDetalleCuota">
                                                <div class="table-responsive" >
                                                        <table class="table table-striped table-bordered table-condensed table-hover" cellpadding="0" cellspacing="0" border="1" class="display" id="tblDetalleCuota">
                                                            <thead>
                                                                <tr>
                                                                    <th>Id Cuota</th>
                                                                    <th>Nro Cuota</th>
                                                                    <th>Tipo de Cuota</th>
                                                                    <th>Fecha Límite</th>
                                                                    <th>Monto Cuota (USD)</th>
                                                                    <th>Total a Pagar<br>(USD)</th>
                                                                    <th>Saldo<br>(USD)</th>
                                                                    <th>Estado</th>
                                                                    <th>Modificar</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody id="VerCuotas">

                                                            </tbody>
                                                        </table>
                                                </div>
                                            </div>

                                            <div class="col-lg-2 col-md-2 col-sm-2 col-xs-2">
                                            </div>
                                            <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 left  has-error">
                                                <div class="input-group">
                                                    <div id="Total" class="input-group-addon">Tasa de Cambio</div>
                                                    <input type="text" class="form-control" id="txtTasa" name="txtTasa" placeholder="Tasa de Cambio Vigente" disabled>
                                                </div>
                                            </div>
                                            <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4 left  has-error">
                                                <div class="input-group">
                                                    <div id="Total" class="input-group-addon">Total a Pagar (USD)</div>
                                                    <input type="text" class="form-control" id="txtTotalPed" name="txtTotalPed" placeholder="Total" disabled>
                                                </div>
                                            </div>
                                            <div class="col-lg-2 col-md-2 col-sm-2 col-xs-2 left has-error">
                                            </div>

                                        </div>

                                        <div class="row">
                                            <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12 left left">
                                                    <h5></h5>
                                                    <a href="Cobranza.php" class="btn btn-primary" ><i class="fa fa-remove"></i> Cancelar</a>
                                                    <hr>
                                                    <span class="lead text-primary"></span>
                                            </div>
                                            <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12 left left" id="idbtncab">
                                                
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </form>
                        </div>

                    </div>
                </div>

                <button class="btn btn-primary" id="btnNuevo"><i class="fa fa-file"></i> Nuevo Cobro</button>
                <br><br>
                <div id="VerListado" class="table-responsive">
                	<table id="tblCobranza" class="table table-striped table-bordered table-condensed table-hover" cellpadding="0" cellspacing="0" width="100%">
                        <thead>
                            <tr>
                            	<th>#</th>
                                <th>Nro. de Recibo</th>
                                <th>Contrato</th>
                                <th>Adquiriente</th>
                                <th>Fecha<br> Cobranza</th>
                                <th>Monto (USD)</th>
                                <th>Estado</th>
                                <th>Concepto</th>
                                <th>Observaciones</th>                                
                                <th style="width:150px;">Opciones</th>
                            </tr>
                        </thead>
                        <tfoot>
                            <tr>
                                <th>#</th>
                                <th>Nro. de Recibo</th>
                                <th>Contrato</th>
                                <th>Adquiriente</th>
                                <th>Fecha<br> Cobranza</th>
                                <th>Monto (USD)</th>
                                <th>Estado</th>
                                <th>Concepto</th>
                                <th>Observaciones</th>                                  
                                <th style="width:150px;">Opciones</th>
                            </tr>
                        </tfoot>
                        <tbody id="cobranza">
                        </tbody>
                    </table>
                </div>
            </div>
        </div><!-- /.row -->
    </div><!-- /.box-body -->
</div><!-- /.box -->


<div id="modalListadoContrato" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">Listado de Contratos</h4>
      </div>
      <div class="modal-body">
      <div class="table-responsive">
        <table id="tblContratos" class="table table-striped table-bordered table-condensed table-hover" cellpadding="0" cellspacing="0" width="100%">
                    <thead>
                        <tr>
                            <th>Seleccione</th>
                            <th>#</th>
                            <th>Nro Contrato</th>
                            <th>Adquiriente</th>
                            <th>Documento</th>
                            <th>Ejecutivo de Venta</th>
                        </tr>
                    </thead>
                    <tfoot>
                        <tr>
                            <th>Seleccione</th>
                            <th>#</th>
                            <th>Nro Contrato</th>
                            <th>Adquiriente</th>
                            <th>Documento</th>
                            <th>Ejecutivo de Venta</th>
                        </tr>
                    </tfoot>
                    <tbody id="ContratoDetalle">
                    </tbody>
                </table>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal"><i class="fa fa-remove"></i> Cerrar</button>
        <button type="button" id="btnAgregarContratoCob" class="btn btn-primary"><i class="fa fa-plus"></i> Agregar</button>
      </div>
    </div>
  </div>
</div>


<div id="modalListadoCuota" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">Listado de Cuotas Pendiente</h4>
      </div>
      <div class="modal-body">
            <div class="table-responsive">
                <table id="tblCuotas" class="table table-striped table-bordered table-condensed table-hover" cellpadding="0" cellspacing="0" width="100%">
                    <thead>
                        <tr>
                            <th>Seleccione</th>
                            <th>#</th>
                            <th>Tipo de Cuota</th>
                            <th>Nro Cuota</th>
                            <th>Fecha Límite</th>
                            <th>Monto</th>
                            <th>Pagado</th>
                            <th>Saldo</th>
                            <th>Estado Cuota</th>
                        </tr>
                    </thead>
                    <tfoot>
                        <tr>
                            <th>Seleccione</th>
                            <th>#</th>
                            <th>Tipo de Cuota</th>
                            <th>Nro Cuota</th>
                            <th>Fecha Límite</th>
                            <th>Monto</th>
                            <th>Pagado</th>
                            <th>Saldo</th>
                            <th>Estado Cuota</th>
                        </tr>
                    </tfoot>
                    <tbody id="CuotaDetalle">
                    </tbody>
                </table>
            </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal"><i class="fa fa-remove"></i> Cerrar</button>
      </div>
    </div>
  </div>
</div>




    <div id="modalListadoPagar" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Facturación</h4>
                </div>
                <div class="modal-body">
      
                <form  role="form" name="frmClienteP" id="frmClienteP" enctype="multipart/form-data">
                    <div class="row">
                        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                            <div class="form-group has-success">
                                <input id="txtIdCobranza2" type="hidden" maxlength="10" class="form-control" name="txtIdCobranza2" placeholder="" autofocus="" value="0"/>
                                <input id="usuario" type="hidden" name="usuario" value="<?php echo $_SESSION['personal'] ?>">
                                <label>Número de Recibo (*):</label>
                                <input autofocus id="txtNroRecibo" type="text" maxlength="20" name="txtNroRecibo" required="" class="form-control" placeholder="Número de Recibo" autofocus="" />
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                            <label>Tipo de Recibo</label>
                            <div class="form-group  has-success">
                                <label class="radio-inline">
                                <input type="radio" name="radTipoRecibo" value="A" checked = "checked" id="reciboAutomatico">Automático</label>
                                <label class="radio-inline">
                                <input type="radio" name="radTipoRecibo" value="M" id="reciboManual">Manual</label>
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                            <label>Tipo Pago</label>
                            <div class="form-group  has-success">
                                <select id="cboTipoPago" name="tipo_pago" class="form-control" >
                                    <option value = "B" >Banco</option>
                                    <option selected="true" value = "E">Efectivo</option>
                                    <option value = "C" >Cheque</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                            <div class="form-group has-success">
                                <label>Fecha de Pago (*):</label>
                                <input id="txtFechaCobranza" type="date" name="txtFechaCobranza" class="form-control" autofocus="" />
                            </div>

                        </div>
                    </div>

                    <div class="row">
                    <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                        <div class="form-group has-success">
                            <label>Incremento (USD):</label>
                            <input id="txtIncremento" value= "0" type="text" maxlength="10" name="txtIncremento" class="form-control" placeholder="Incremento" autofocus="" />
                        </div>
                    </div>
                    <div class="col-lg-9 col-md-9 col-sm-6 col-xs-12">
                        <div class="form-group has-success">
                            <label>Objeto del Incremento :</label>
                            <input  id="txtObjetoIncremento" type="text" maxlength="255" name="txtObjetoIncremento" class="form-control" placeholder="Objeto del Incremento" autofocus="" />
                        </div>
                    </div>
                    </div>

                    <div class="row">
                        <div class="col-lg-9 col-md-9 col-sm-12 col-xs-12">
                            <div class="form-group has-success">
                                <label>Concepto del Pago (*):</label>
                                <input  required="" id="txtConcepto" type="text" maxlength="255" name="txtConcepto" class="form-control" placeholder="Concepto del Pago" required="" autofocus="" />
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-12 col-xs-12">
                            <div class="form-group has-success">
                                <label>Persona que Realizo el Pago :</label>
                                <input  required="" id="txtNombre" type="text" maxlength="50" name="txtNombre" class="form-control" placeholder="Persona que Paga" required="" autofocus="" />
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                            <div class="form-group has-success">
                                <label>Observaciones:</label>
                                <input id="txtObservaciones" type="text" maxlength="255" name="txtObservaciones" class="form-control" placeholder="Observaciones del Pago" autofocus="" />
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-9 col-md-9 col-sm-6 col-xs-12">
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                            <div class="form-group has-success">
                                <label>Descuento:</label>
                                <input id="txtDescuento" value=0 type="text" maxlength="10" name="txtDescuento" class="form-control" placeholder="Descuento" autofocus="" />
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                            <label>Emitir Recibo en: </label>
                            <div class="form-group  has-success">
                                <label class="radio-inline">
                                <input type="radio" name="radEmiteRecibo" value="B" id="monedaBolivianos">Bolivianos</label>
                                <label class="radio-inline">
                                <input type="radio" name="radEmiteRecibo" value="D" checked = "checked" id="monedaDolares">Dolares</label>
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                            <div class="form-group has-success">
                                <label>Tasa de Cambio (Bs./USD):</label>
                                <input id="tasaCambio"  style =" height:45px; color:white; background:gray;" readonly type="text" maxlength="10"  required="" class="form-control" placeholder="Total" autofocus="" />
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                            <div class="form-group has-success">
                                <label>Total a Pagar Bolivianos (Bs.):</label>
                                <input id="totalPagarBs"  style =" height:45px; color:black; background:yellow;" readonly type="text" maxlength="20"  required="" class="form-control" placeholder="Total" autofocus="" />
                            </div>
                        </div>
                        <div class="col-lg-3 col-md-3 col-sm-6 col-xs-12">
                            <div class="form-group has-success">
                                <label>Total a Pagar Dolares (USD):</label>
                                <input id="totalPagar"  style =" height:45px; color:black; background:yellow;" readonly type="text" maxlength="20"  required="" class="form-control" placeholder="Total" autofocus="" />
                            </div>
                        </div>
                    </div>






                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal"><i class="fa fa-remove"></i> Cerrar</button>
                        <button type="button" id="btnGenerarCobro" class="btn btn-warning" ><i class="fa fa-floppy-o"></i> Generar Cobro</button>
                        <label type="button" id="btnActCobro" onclick="modificaCabPago();" class="btn btn-warning" ><i class="fa fa-floppy-o"></i> Actualizar</label>
                    </div> <!-- Fin modal footer -->
                </form>
                </div>

            </div>  <!-- fin modal content -->
        </div><!-- fin modal dialog -->
    </div> <!-- fin modal  -->

    <div id="modalAbonarPago" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabelAbonar">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Abonar Pago</h4>
                </div>
                <div class="modal-body">
                    <form  role="form" name="frmAbonarPago" id="frmAbonarPago" enctype="multipart/form-data">
                        <input type="hidden" id="indiceregistro">
                        <div class="row">
                            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                                <div class="form-group has-success">
                                    <label>Total a Pagar Dolares (USD):</label>
                                    <input id="totalAbono"  style =" height:45px; color:black; background:yellow;" type="number" step="0.01" maxlength="12"  required="" class="form-control align-right" min="1"  placeholder="Total a Pagar" autofocus />
                                </div>
                            </div>
                        </div>

                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal"><i class="fa fa-remove"></i> Cerrar</button>
                            <button type="button"  data-dismiss="modal" id="btnAbonarPago" class="btn btn-warning" ><i class="fa fa-floppy-o"></i> Aceptar Pago</button>
                        </div> <!-- Fin modal footer -->
                    </form>
                </div>
            </div>  <!-- fin modal content -->
        </div><!-- fin modal dialog -->
    </div> <!-- fin modal  -->


















<script type="text/javascript">

    $('#liContrato').addClass("treeview active");

    $('#liCobranzas').addClass("active");

    const input = document.getElementById('txtNroRecibo');

    input.addEventListener('focusin', (event) => {
      event.target.style.background = 'pink';
    });

    input.addEventListener('focusout', (event) => {
        receiptNumber = document.getElementById('txtNroRecibo').value;
        event.target.style.background = 'white';
        ifReceiptNumberExist(receiptNumber);
    });

</script>

